<!DOCTYPE html>
<!--
This is a starter template page. Use this page to start your new project from
scratch. This page gets rid of all links and provides the needed markup only.
-->
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>SmartCHARGE EVSE</title>
    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <!-- Bootstrap 3.3.5 -->
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <!-- Ionicons -->
    <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <!-- Theme style -->
    <link rel="stylesheet" href="dist/css/AdminLTE.min.css">
    <!-- AdminLTE Skins. We have chosen the skin-blue for this starter
          page. However, you can choose any other skin. Make sure you
          apply the skin class to the body tag so the changes take effect.
    -->
    <link rel="stylesheet" href="dist/css/skins/skin-green.css">
	<link rel="shortcut icon" type="image/x-icon" href="favicon.ico"/>


	
	<script src="https://code.jquery.com/jquery-1.10.2.js"></script>
	
	
	
	
	   <!-- James Added Firebase Script    -->
    <script src='https://cdn.firebase.com/js/client/2.2.1/firebase.js'></script>
	
		<!-- James Added Styling    -->
	<style>
	::-webkit-input-placeholder {
	   font-style: italic;
	}
	:-moz-placeholder {
	   font-style: italic;  
	}
	::-moz-placeholder {
	   font-style: italic;  
	}
	:-ms-input-placeholder {  
	   font-style: italic; 
	}  


	.styled-select select {
	   background: transparent;
	   width: 60px;
	   padding: 2px;
	   font-size: 14px;
	   line-height: 1;
	   border: 1;
	   border-radius: 0;
	   border-color: #ffffff;
	   height: 26px;
	   -webkit-appearance: none;
	   }
	</style>
	
  </head>





  <body class="hold-transition skin-green sidebar-mini">

    <div class="wrapper">

      <!-- Main Header -->
      <header class="main-header">

        <!-- Logo -->
        <a class="logo" href ="index.html">
          <!-- logo for regular state and mobile devices -->
          <span class="logo-lg"><b>Smart</b>CHARGE <i class="fa fa-battery-three-quarters"></i></span>
		  <span class="logo-mini"><b>S</b>C <i class="fa fa-battery-three-quarters"></i></span>
        </a>
		
		<nav class="navbar navbar-static-top" role="navigation">
		 <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">
            <span class="sr-only">Toggle navigation</span>
          </a>
		</nav>
	  </header>
      <!-- Left side column. contains the logo and sidebar -->
      <aside class="main-sidebar">

        <!-- sidebar: style can be found in sidebar.less -->
        <section class="sidebar">

          <!-- Sidebar Menu -->
          <ul class="sidebar-menu">
            <li class="header">NAVIGATION</li>
            <!-- Optionally, you can add icons to the links -->
			<!-- set li class to active if page is active... Pls??-->
            <li><a href="index.html"><i class="fa fa-home"></i><span>&#09;Home</span></a></li>
            <li><a href="history.html"><i class="fa fa-pie-chart"></i><span>&#09;History</span></a></li>
            <li><a href="configure.html"><i class="fa fa-wifi"></i><span>&#09;Configure</span></a></li>
			<li><a href="sponsors.html"><i class="fa fa-usd"></i><span>&#09;Sponsors</span></a></li>
          </ul><!-- /.sidebar-menu -->
        </section>
        <!-- /.sidebar -->
      </aside>

      <!-- Content Wrapper. Contains page content -->
      <div class="content-wrapper">
        <!-- Content Header (Page header) -->
        <section class="content-header">		
        <h1>
			Configure Your Charger
        </h1>
	  
        </section>
        <!-- Main content -->
		<section class="content">
		
			<div class="box box-default color-palette-box">
				<div class="box-header with-border">
					<h3 class="box-title"><i class="fa fa-map-pin"></i> Set a Location </h3>
				</div>
				<div class="box-body">
					<table border = "0" >
						<tr>
							<td style="vertical-align: center; padding:10px;">				
								Select your location to learn  more about local electricity pricing: 
							</td>
							
							<td style="vertical-align: center;padding:10px;">
								<select class="form-control" id="SelectLoc">
									 <option selected="true" style="display:none;"></option>
									 <option value ="StCath_TOU">St.Catharines</option>
									 <option value ="Hamilton_TOU">Hamilton</option>
									 <option value ="Welland_TOU">Welland</option>
									 <option value ="Grimsby_TOU">Grimsby</option>
								</select>
							</td>				
						
						</tr>
					</table>
					<img src="images/Hamilton_TOU.jpg" id="Hamilton_TOU" align = "center" style="display:none;">
					<img src="images/Grimsby_TOU.jpg" id="Grimsby_TOU" align = "center" style="display:none;">
					<img src="images/StCath_TOU.jpg" id="StCath_TOU" align = "center" style="display:none;">
					<img src="images/Welland_TOU.jpg" id="Welland_TOU" align = "center" style="display:none;">
				</div>
				
				<script>
				
				var i = 0;
				var recent= ""; // The last clicked city.
				$( "#SelectLoc" ).change(function() {
					//Retreive Selected City from dropdown:
					var e = document.getElementById("SelectLoc");
					var City = e.options[e.selectedIndex].value;
					
					
					
													
					console.log("City Pressed =  " + City);
					console.log("Last City Pressed =  " + recent);
					console.log("i = " + i);
					//Load Image for Selected City:
					if(City == "StCath_TOU") 
					{							
						if(i != 0){$( recent ).slideToggle( "slow" );}
						$( "#StCath_TOU" ).slideToggle( "slow" );
						recent = "#StCath_TOU";
						i++;
					}
					
					if(City == "Hamilton_TOU")
					{	
						if(i != 0){$( recent ).slideToggle( "slow" );}						
						$( "#Hamilton_TOU" ).slideToggle( "slow" );			
						recent = "#Hamilton_TOU";
						i++;
					}
					
					if(City == "Welland_TOU")
					{
						if(i != 0){$( recent ).slideToggle( "slow" );}
						$( "#Welland_TOU" ).slideToggle( "slow" );		
						recent = "#Welland_TOU";
						i++;
					}
					
					if(City == "Grimsby_TOU")
					{
						$( recent ).slideToggle( "slow" );		
						$( "#Grimsby_TOU" ).slideToggle( "slow" );	
						recent = "#Grimsby_TOU";
						i++;
					}							
				});				
				</script>

			</div>	
		
			<div class="box box-default color-palette-box">
				<div class="box-header with-border">
					<h3 class="box-title"><i class="fa fa-calendar"></i> Set a Charging Schedule </h3>
				</div>		
				
				
				<div class="box-body">
					<div><p id="greeting"> </p></div>
					<div><p><i> To remove your charging schedule entirely, select the "None" option for each time and hit save. </i> </p></div>
					
					
					
					 <table  align="center" >
						  <tr >
							<td style="padding: 8px;"><b>Start Time :</b> </td>
							<td style="padding: 8px;"> <input id="StartTimePicker" placeholder="Start Time"  style="text-align:center;" size="15" /></td>
							<td style="padding: 8px;"><div class="styled-select"><select id = "StartTimeAMPM">	<option value ="AM" >AM</option><option value ="PM">PM</option> </select></div></td>
						  </tr>
						  <tr>
							<td style="padding: 8px;"> <b>End Time :</b>  </td>
							<td style="padding: 8px;"> <input id="EndTimePicker" placeholder = "End Time" style="text-align:center;"  size="15"/></td>
							<td style="padding: 8px;"><div class="styled-select"><select id = "EndTimeAMPM">	<option value ="AM" >AM</option><option value ="PM">PM</option> </select></div></td>
						  </tr>
						  <tr>
							<td style="padding: 8px;">  </td>
							<td style="padding: 8px;" align="center"> <button type="button" class="btn btn-primary" onclick="SaveSchedule()"  style = "background-color:#008d4c">Save</button></td>
							<td style="padding: 8px;"></td>
						  </tr>
					 </table> 	
					</div>

					<script>
						$(function() {
							$('#StartTimePicker').val('');
							$('#StartTimePicker').timepicker({
								'minTime': '12:15pm',
								'maxTime': '12am',
								'timeFormat': 'g:i',
								'step': 15,
								'noneOption' : [
								{
									'label': 'None',
									'value': 'None'
								}
								]						
							});
						});
						$(function() {
							$('#EndTimePicker').val('');
							$('#EndTimePicker').timepicker({
								'minTime': '12:15pm',
								'maxTime': '12am',
								'timeFormat': 'g:i',
								'step': 15,
								'noneOption' : [
								{
									'label': 'None',
									'value': 'None'
								}
								]					
							});
						});						
					</script>	

					
					<script>
					var myDataRef = new Firebase('https://glowing-torch-5452.firebaseio.com/');  
					var Sched = myDataRef.child("Schedule");
					 
					Sched.on("value", function(snapshot) {
						var FBSchedule = snapshot.val();
						
						if(FBSchedule.StartTime =="None" || FBSchedule.EndTime =="None" ){
							document.getElementById("greeting").innerHTML = "Your current Charging Schedule is not set! Use the form below to set an automated charging schedule.  "   ;
						}
						else {
							document.getElementById("greeting").innerHTML = "Your schedule is current set from <b>" +  FBSchedule.StartTime + "</b> to <b>" + FBSchedule.EndTime + "</b>. Use the form below to modify these times."  ;						
						}
						console.log("Schedule Changed:");
						console.log("StartTime = " + FBSchedule.StartTime);	
						console.log("EndTime = " + FBSchedule.EndTime);
					});
					 
					 function SaveSchedule() 
					{
						if(	document.getElementById("StartTimePicker").value == '' || document.getElementById("EndTimePicker").value =='')
							{
								document.getElementById("Alert_Message").innerHTML = "Please enter valid start and end times!";
							}
						else
						{
							var myDataRef = new Firebase('https://glowing-torch-5452.firebaseio.com/');
							var Sched = myDataRef.child("Schedule");
							
							var Start = document.getElementById("StartTimePicker").value;
							var End = document.getElementById("EndTimePicker").value;
							
							if( (Start == "None" ) && ( End == "None") ) {
								Sched.child("StartTime").set("None");
								Sched.child("EndTime").set("None");
								document.getElementById("StartTimePicker").value = "";
								document.getElementById("EndTimePicker").value = "";						
								document.getElementById("Alert_Message").innerHTML = "Schedule has been removed!";
							}
							else{
								var STAMPM = document.getElementById("StartTimeAMPM");
								var Start_AMPM = STAMPM.options[STAMPM.selectedIndex].text;
								var FTAMPM = document.getElementById("EndTimeAMPM");
								var Finish_AMPM = FTAMPM.options[FTAMPM.selectedIndex].text;
								Sched.child("StartTime").set(Start + Start_AMPM);
								Sched.child("EndTime").set(End + Finish_AMPM);
							
								document.getElementById("StartTimePicker").value = "";
								document.getElementById("EndTimePicker").value = "";						
								document.getElementById("Alert_Message").innerHTML = "Schedule Saved Successfully!";
							}
						}
					}
					</script>
					<p id = "Alert_Message" align="center" style="font-style: italic"> </p>
				</div>					
			</div>		
		</section><!-- /.content -->
			
      </div><!-- /.content-wrapper -->
 
    <!-- REQUIRED JS SCRIPTS -->
    <!-- jQuery 2.1.4 -->
    <script src="plugins/jQuery/jQuery-2.1.4.min.js"></script>
    <!-- Bootstrap 3.3.5 -->
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <!-- AdminLTE App -->
    <script src="dist/js/app.min.js"></script>
	
	<!-- JAMES ADDED: TimePicker Plugin: -->
	<script src="TimePicker/jquery.timepicker.min.js"></script>
	<link rel="stylesheet" href="TimePicker/jquery.timepicker.css">	
	<link rel="stylesheet" type="text/css" href="TimePicker/lib/bootstrap-datepicker.css" />
	

  </body>
</html>
